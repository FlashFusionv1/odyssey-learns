<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <title>Inner Odyssey - The Learning Adventure</title>
    <meta name="description" content="Enhance, engage and support your child's mental prowess!">
    <meta name="author" content="Inner Odyssey" />
    
    <!-- Performance: Preconnect to critical origins -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://hcsglifjqdmiykrrmncn.supabase.co" />
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#FF6B9D" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Inner Odyssey" />
    <link rel="apple-touch-icon" href="/pwa-192x192.png" />
    <link rel="manifest" href="/manifest.webmanifest" />
    
    <!-- Open Graph / Social -->
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />
    <meta property="og:title" content="Inner Odyssey - The Learning Adventure">
    <meta property="og:description" content="Enhance, engage and support your child's mental prowess!">

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@lovable_dev" />
    <meta name="twitter:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />
    <meta name="twitter:title" content="Inner Odyssey - The Learning Adventure">
    <meta name="twitter:description" content="Enhance, engage and support your child's mental prowess!">
    
    <!-- Performance: Font display swap -->
    <style>
      @font-face {
        font-family: 'Inter';
        font-display: swap;
        src: local('Inter');
      }
    </style>
    <!-- Critical CSS for initial loading state -->
    <style>
      .app-loading {
        position: fixed;
        inset: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, hsl(220 20% 98%) 0%, hsl(260 10% 96%) 100%);
        z-index: 9999;
        transition: opacity 0.3s ease-out;
      }
      .app-loading.hide {
        opacity: 0;
        pointer-events: none;
      }
      .app-loading-spinner {
        width: 48px;
        height: 48px;
        border: 4px solid hsl(260 60% 90%);
        border-top-color: hsl(260 60% 60%);
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
      }
      .app-loading-text {
        margin-top: 16px;
        color: hsl(220 10% 40%);
        font-family: system-ui, -apple-system, sans-serif;
        font-size: 14px;
      }
      .app-loading-progress {
        margin-top: 8px;
        color: hsl(220 10% 60%);
        font-family: system-ui, -apple-system, sans-serif;
        font-size: 12px;
      }
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
      @media (prefers-color-scheme: dark) {
        .app-loading {
          background: linear-gradient(135deg, hsl(220 20% 10%) 0%, hsl(260 10% 12%) 100%);
        }
        .app-loading-spinner {
          border-color: hsl(260 30% 30%);
          border-top-color: hsl(260 60% 60%);
        }
        .app-loading-text {
          color: hsl(220 10% 70%);
        }
        .app-loading-progress {
          color: hsl(220 10% 50%);
        }
      }
      /* Root placeholder to prevent false white screen detection */
      #root:empty::before {
        content: '';
        display: block;
        min-height: 1px;
      }
    </style>
  </head>

  <body>
    <!-- Initial loading state (removed by React when ready) -->
    <div id="app-loader" class="app-loading">
      <div class="app-loading-spinner"></div>
      <p class="app-loading-text">Loading Inner Odyssey...</p>
      <p class="app-loading-progress" id="loading-progress">Initializing...</p>
    </div>
    
    <!-- Root with placeholder content to prevent false white screen detection -->
    <div id="root"><!-- React will mount here --></div>
    
    <!-- Minimal PWA startup script - no aggressive recovery -->
    <script>
      (function() {
        'use strict';
        
        // Simple progress update
        function updateProgress(text) {
          var el = document.getElementById('loading-progress');
          if (el) el.textContent = text;
        }
        
        // Clear any stuck recovery state from previous attempts
        try {
          localStorage.removeItem('pwa_recovery_attempts');
          localStorage.removeItem('pwa_recovery_cooldown');
          localStorage.removeItem('pwa_health_timestamp');
          localStorage.removeItem('pwa_init_state');
        } catch (e) {}
        
        // Just update progress, no recovery logic
        updateProgress('Starting application...');
        
        // Simple timeout to hide loader if React doesn't (fallback only)
        setTimeout(function() {
          var loader = document.getElementById('app-loader');
          var root = document.getElementById('root');
          // Only hide if React has mounted content
          if (loader && root && root.innerHTML.length > 100) {
            loader.classList.add('hide');
          }
        }, 30000); // 30 second fallback
      })();
    </script>
    
    <script type="module" src="/src/main.tsx"></script>
    <script src="https://www.google.com/recaptcha/api.js?render=6LeIxAcTAAAAAJcZVRqyHh71UMIEGNQ_MXjiZKhI" defer></script>
  </body>
</html>
